#!/usr/bin/env bash
### NanoPhase master script 
set -eo pipefail

##
VERSION="0.2.0"

###### Usage ######
show_help(){
cat << EOF

`echo "NanoPhase v=$VERSION"`

Main modules
	check			check if all packages have been installed
	meta                    genome assembly, binning, quality assessment and classification for metagenomic datasets
	isolate			genome assembly, binning, quality assessment and classification for bacterial isolates

Test modules
	args			Antibiotic Resistance Genes (ARGs) identification from reconstructed MAGs

Other options
	-h | --help		show the help message
	-v | --version		show NanoPhase version

example usage:
        NanoPhase check 											## package availability checking
        NanoPhase meta -l ont.fastq.gz -t 16 -o NanoPhase-out							## meta::long reads only
        NanoPhase meta -l ont.fastq.gz --hybrid -1 sr_1.fastq.gz -2 sr_2.fastq.gz -t 16 -o NanoPhase-out	## meta::hybrid strategy
	NanoPhase isolate -l ont.fastq.gz -t 16 -o NanoPhase-out 						## isolate::long reads only
	NanoPhase isolate -l ont.fastq.gz --hybrid -1 sr_1.fastq.gz -2 sr_2.fastq.gz -t 16 -o NanoPhase-out 	## isolate::hybrid strategy
	NanoPhase args -i Final-bins -x fasta -o NanoPhase.ARGs.summary.txt					## ARGs identification

EOF
}

### 
base_dir=$(cd `dirname $0`; pwd)
#base_path=`realpath $0`
#base_dir=`dirname $base_path`

if [[ "$1" == check ]]; then
	$base_dir/NanoPhase.check
elif [[ "$1" == isolate ]]; then
	#echo NanoPhase isolate ${@:2}
	$base_dir/NanoPhase.iso ${@:2}
elif [[ "$1" == meta ]]; then
	#echo NanoPhase meta ${@:2}
	$base_dir/NanoPhase.meta ${@:2}
elif [[ "$1" == args ]]; then
	$base_dir/NanoPhase.args ${@:2}
elif [[ "$1" = "-h" ]] || [[ "$1" = "--help" ]]; then
	show_help
elif [[ "$1" = "-v" ]] || [[ "$1" = "--version" ]]; then
	echo "NanoPhase v=$VERSION"
elif [[ "$1" = "" ]]; then
	show_help
else
	echo "Error: please check the input NanoPhase module; now show NanoPhase -h"
	show_help
	exit 1
fi



